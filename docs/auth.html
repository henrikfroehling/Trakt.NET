<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Authentication and Authorization | Trakt.NET </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Authentication and Authorization | Trakt.NET ">
      <meta name="generator" content="docfx ">
  
      <link rel="shortcut icon" href="../favicon.ico">
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/night-owl.min.css">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" integrity="sha384-EvBWSlnoFgZlXJvpzS+MAUEjvN7+gcCwH+qh7GRFOGgZO0PuwOFro7qPOJnLfe7l" crossorigin="anonymous">
      <link rel="stylesheet" href="../styles/config.css">
      <link rel="stylesheet" href="../styles/discord.css">
      <link rel="stylesheet" href="../styles/singulink.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="../toc.html">
      <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="../">
  <meta property="docfx:newtab" content="true">
    </head>
    <body>
        <div class="top-navbar">
            <a class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="34" height="34" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>


            <a class="brand" href="../index.html">
              <img src="../logo.svg" alt="Trakt.NET" class="logomark">
              <span class="brand-title">Trakt.NET</span>
            </a>        </div>

        <div class="body-content">
            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">
                <div class="sidebar">

                    <div>
                      <div class="mobile-hide">

                        <a class="brand" href="../index.html">
                          <img src="../logo.svg" alt="Trakt.NET" class="logomark">
                          <span class="brand-title">Trakt.NET</span>
                        </a>                      </div>

                      <div class="sidesearch">
                        <form id="search" role="search" class="search">
                            <i class="bi bi-search search-icon"></i>
                            <input type="text" id="search-query" placeholder="Search" autocomplete="off">
                        </form>
                      </div>

                      <div id="navbar">
                      </div>
                    </div>                    <div class="sidebar-item-separator"></div>

                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>
                </div>
                <div class="footer">
  <span>Made with <a href='https://dotnet.github.io/docfx/'>docfx</a></span>
  
                </div>            </nav>

            <main class="main-panel">

                <div id="search-results" style="display: none;">
                  <h1 class="search-list">Search Results for <span></span></h1>
                  <div class="sr-items">
                    <p><i class="bi bi-hourglass-split index-loading"></i></p>
                  </div>
                  <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
                </div>
                <div role="main" class="hide-when-search">

                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="">
<h1 id="authentication-and-authorization">Authentication and Authorization</h1>

<p>Authentication is necessary if you need to call Trakt API requests, that require authorization. Every method in the library, that requires authorization, indicates this in its method documentation.</p>
<p>The Trakt API provides two methods for authenticating users and both are supported by the library. See <a href="auth.html#oauth-authentication">here</a> and <a href="auth.html#device-authentication">here</a> for more information.</p>
<h3 id="authorization">Authorization</h3>
<p>Authorization information for the Trakt API contains not only the access token but also a refresh token, that makes it possible to retrieve new authorization information without authenticating the user again and without the need of the user to interact.</p>
<p>The <a class="xref" href="../api/TraktNet.Objects.Authentication.TraktAuthorization.html"><code>TraktAuthorization</code></a> class represents such authorization information. It also contains the UTC DateTime, when it was created and can tell you if it is expired and if the containing authorization information can be <a href="auth.html#refresh-authorization">refreshed</a>. You can get a new TraktAuthorization instance by authenticating the user either with <a href="auth.html#oauth-authentication">OAuth</a>- or <a href="auth.html#device-authentication">Device</a>-Authentication.</p>
<p>If you already have an access token (and optionally a refresh token), you can create a new <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html"><code>ITraktAuthorization</code></a> instance in one of the following ways:</p>
<pre><code class="lang-csharp">using TraktNet.Objects.Authentication;

ITraktAuthorization authorization = TraktAuthorization.CreateWith(&quot;existing access token&quot;);

// or

ITraktAuthorization authorization = TraktAuthorization.CreateWith(&quot;existing access token&quot;, &quot;existing refresh token&quot;);

// or,
// if you also have the DateTime, when the authorization was created
// and the value, after which the authorization expires

DateTime createdAt = DateTime.Now.AddDays(-30); // 30 days ago
uint expiresInSeconds = 3600 * 24 * 90; // 90 days (default value), has to be in seconds

ITraktAuthorization authorization = TraktAuthorization.CreateWith(createdAt, expiresInSeconds, &quot;existing access token&quot;);
ITraktAuthorization authorization = TraktAuthorization.CreateWith(createdAt, expiresInSeconds, &quot;existing access token&quot;, &quot;existing refresh token&quot;);

// or

ITraktAuthorization authorization = TraktAuthorization.CreateWith(expiresInSeconds, &quot;existing access token&quot;);
ITraktAuthorization authorization = TraktAuthorization.CreateWith(expiresInSeconds, &quot;existing access token&quot;, &quot;existing refresh token&quot;);

// or

ITraktAuthorization authorization = TraktAuthorization.CreateWith(createdAt, &quot;existing access token&quot;);
ITraktAuthorization authorization = TraktAuthorization.CreateWith(createdAt, &quot;existing access token&quot;, &quot;existing refresh token&quot;)
</code></pre><p>And then just pass it to your <a class="xref" href="../api/TraktNet.TraktClient.html"><code>TraktClient</code></a> instance:</p>
<pre><code class="lang-csharp">client.Authorization = authorization;
</code></pre><h3 id="oauth-authentication">OAuth Authentication</h3>
<p>The workflow for authenticating users with the <a href="https://trakt.docs.apiary.io/#reference/authentication-oauth">traditional OAuth method</a> is the following:</p>
<ol>
<li>Create an authorization URL: <code>string authorizationUrl = client.Authentication.CreateAuthorizationUrl();</code> <a class="xref" href="../api/TraktNet.Modules.TraktAuthenticationModule.html#TraktNet_Modules_TraktAuthenticationModule_CreateAuthorizationUrl">Reference</a></li>
<li>Your users need to visit the <code>authorizationUrl</code>&#39;s webpage.</li>
<li>Your users need to provide you a PIN code that they get from Trakt.tv.</li>
<li>Get authorization with the PIN code provided by your users:</li>
</ol>
<pre><code class="lang-csharp">using TraktNet.Objects.Authentication;

string code = &quot;12345678&quot;; // PIN code from your users
ITraktAuthorization authorization = await client.Authentication.GetAuthorizationAsync(code);

// or

client.Authentication.OAuthAuthorizationCode = code;
ITraktAuthorization authorization = await client.Authentication.GetAuthorizationAsync();
</code></pre><div class="NOTE"><h5>Note</h5><p>You don&#39;t need to pass the returned <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html"><code>ITraktAuthorization</code></a> to your <a class="xref" href="../api/TraktNet.TraktClient.html"><code>TraktClient</code></a> instance. This happens automatically inside the library.</p>
</div>
<div class="NOTE"><h5>Note</h5><p>A <a class="xref" href="../api/TraktNet.Exceptions.TraktAuthenticationOAuthException.html"><code>TraktAuthenticationOAuthException</code></a> will be thrown if the code provided by your users is invalid.</p>
</div>
<p><a href="../examples/auth/oauth-authentication.html">Here</a> is an example of how to authenticate a user with OAuth Authentication.</p>
<h3 id="device-authentication">Device Authentication</h3>
<p>The workflow for authenticating users with the <a href="https://trakt.docs.apiary.io/#reference/authentication-devices">Device method</a> is the following:</p>
<ol>
<li>Create a new <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktDevice.html"><code>ITraktDevice</code></a>: <code>ITraktDevice device = await client.Authentication.GenerateDeviceAsync();</code> (<a class="xref" href="../api/TraktNet.Modules.TraktAuthenticationModule.html#TraktNet_Modules_TraktAuthenticationModule_GenerateDeviceAsync_System_String_System_Threading_CancellationToken_">Reference</a>) The returned <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktDevice.html"><code>ITraktDevice</code></a> is valid for about ten minutes and contains a device code and a verification URL.</li>
<li>Your users need to visit the <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktDevice.html#TraktNet_Objects_Authentication_ITraktDevice_VerificationUrl"><code>device.VerificationUrl</code></a>&#39;s web page and to enter the <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktDevice.html#TraktNet_Objects_Authentication_ITraktDevice_UserCode"><code>device.UserCode</code></a> on that web page.</li>
<li>Simultaneously you need to poll for the new authorization. This process will stop as soon as your users have authenticated your application. But the process will not take any longer than 10 minutes. If your users have not authenticated your application after the given time period, you need to start over the whole process as of step (1).</li>
</ol>
<pre><code class="lang-csharp">using TraktNet.Objects.Authentication;

ITraktAuthorization authorization = await client.Authentication.PollForAuthorizationAsync();
</code></pre><div class="NOTE"><h5>Note</h5><p>You don&#39;t need to pass the returned <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html"><code>ITraktAuthorization</code></a> to your <a class="xref" href="../api/TraktNet.TraktClient.html"><code>TraktClient</code></a> instance. This happens automatically inside the library.</p>
</div>
<div class="NOTE"><h5>Note</h5><p>A <a class="xref" href="../api/TraktNet.Exceptions.TraktAuthenticationDeviceException.html"><code>TraktAuthenticationDeviceException</code></a> will be thrown, if <a class="xref" href="../api/TraktNet.Modules.TraktAuthenticationModule.html#TraktNet_Modules_TraktAuthenticationModule_PollForAuthorizationAsync_System_Threading_CancellationToken_"><code>PollForAuthorizationAsync()</code></a> fails.</p>
</div>
<p><a href="../examples/auth/device-authentication.html">Here</a> is an example of how to authenticate a user with Device Authentication.</p>
<h3 id="refresh-authorization">Refresh Authorization</h3>
<p>The Trakt authorization information will be valid for 90 days for each one of your users. You need to refresh the authorization before the current one expires. Your <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html"><code>ITraktAuthorization</code></a> needs to have a valid refresh token set. You can check this with its property <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html#TraktNet_Objects_Authentication_ITraktAuthorization_IsRefreshPossible"><code>IsRefreshPossible</code></a>. The <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html"><code>ITraktAuthorization</code></a> interface has the property <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html#TraktNet_Objects_Authentication_ITraktAuthorization_IsExpired"><code>IsExpired</code></a>, that tells you if it is expired. To check, if an authorization was revoked by the user, you can call the following method:</p>
<pre><code class="lang-csharp">using TraktNet.Objects.Authentication;

// Precondition: client.Authorization is already set
bool expiredOrRevoked = await client.Authentication.CheckIfAuthorizationIsExpiredOrWasRevokedAsync();

// or

ITraktAuthorization yourAuthorization = TraktAuthorization.CreateWith(&quot;access token&quot;);
bool expiredOrRevoked = await client.Authentication.CheckIfAuthorizationIsExpiredOrWasRevokedAsync(yourAuthorization);
</code></pre><p>Alternatively, you can directly check an access token:</p>
<pre><code class="lang-csharp">string myAccessToken = &quot;access token&quot;;
bool revoked = await client.Authentication.CheckIfAccessTokenWasRevokedOrIsNotValidAsync(myAccessToken);
</code></pre><p>To actually refresh the current authorization, simply call the following method:</p>
<pre><code class="lang-csharp">using TraktNet.Objects.Authentication;

// Precondition: client.Authorization is already set
ITraktAuthorization newAuthorization = await client.Authentication.RefreshAuthorizationAsync();
</code></pre><div class="NOTE"><h5>Note</h5><p>You don&#39;t need to pass the returned <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html"><code>ITraktAuthorization</code></a> to your <a class="xref" href="../api/TraktNet.TraktClient.html"><code>TraktClient</code></a> instance. This happens automatically inside the library.</p>
</div>
<h3 id="revoke-authorization">Revoke Authorization</h3>
<p>Revoking the current authorization is also very simple:</p>
<pre><code class="lang-csharp">await client.Authentication.RevokeAuthorizationAsync();
</code></pre><div class="NOTE"><h5>Note</h5><p>After a successful call to <a class="xref" href="../api/TraktNet.Modules.TraktAuthenticationModule.html#TraktNet_Modules_TraktAuthenticationModule_RevokeAuthorizationAsync_System_Threading_CancellationToken_"><code>RevokeAuthorizationAsync()</code></a>, <a class="xref" href="../api/TraktNet.TraktClient.html#TraktNet_TraktClient_Authorization"><code>client.Authorization</code></a> will return a default and invalid <a class="xref" href="../api/TraktNet.Objects.Authentication.ITraktAuthorization.html"><code>ITraktAuthorization</code></a> instance.</p>
</div>
</article>
                </div>

                <div class="copyright-footer">
                    <span>Copyright &#169; 2016 - Current Henrik Fr&#246;hling et al.</span>
                </div>
            </main>
        </div>


        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
        <script type="text/javascript" src="../styles/jquery.twbsPagination.js"></script>
        <script type="text/javascript" src="../styles/url.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
        <script type="text/javascript" src="../styles/docfx.js"></script>
        <script type="text/javascript" src="../styles/singulink.js"></script>
        <script type="text/javascript" src="../styles/main.js"></script>    </body>
</html>
